# https

## 原理

### http 的安全问题

> 类似邮件/快递中，快递员可以把邮件打开甚至串改篡改
> `fiddler web debugger`

1. http 协议是明文协议，每个人都能看到，传递的数据容易被偷窥篡改
2. 解决: 对称加密

- 需要协商密钥(加密的规则)发送前用密钥加密，收到时用密钥解密，加密和解密是同一个密钥
- 优点: 速度非常快
- 缺点: 安全传递密钥很麻烦,密钥有泄漏的风险

3. 解决: 非对称加密

- 密钥是一对，公钥+私钥
  - 使用公钥加密的数据只能用私钥解密，使用私钥加密的数据只能用公钥解密
  - 私钥加密公钥解密是用来加密数据
  - 公钥加密私钥解密是用来数字签名的
    > 数学基础：两个超大的素数求乘积非常容易，但是分解因子非常麻烦
    > 所以把乘积当成公钥，某个因子当成私钥自己保留,一般用 rsa 算法 aes  
    > 张三的公钥 李四的公钥 每个人保存自己的私钥公钥和对方的公钥，用对方的公钥加密后传输数据，收到后用自己的私钥解密 所以中间人解不开
- 非对称加密算起俩特别慢，比对称加密慢了 100 多倍

4. 非对称加密与对称加密结合

   - TLS: 二者约定一个对称的密钥，发送者把对称的密钥用接受者的公钥加密后传递给接受者，接受者拿到对称的密钥后，以后的数据传输都是用对称加密 1.用基本信息算出摘要 2.使用权威机构的公钥验证签名

1.
1. 3.如何防止摘要被篡改?证书

## 实战

## 如何在你的服务器上部署 https (免费的 https 证书)

散列算法
MD5 和 SHA_1 已经被破解了，现在使用的是 SHA256
抓包工具 wireshark，可以抓 TCP 和网络层协议，比 fiddle 强大，fiddle 只能抓 http 协议
https 相当于是用 RSA 来交换 AES 的密钥 diffie-Hellman 算法专门用来交换密钥

非对称加密
RSA 大的素数分解
ECC 椭圆曲线
The connection to this site is encrypted and authenticated using TLS 1.2, ECDHE RSA with P-256 and AES 256 GCM
签名 公钥
加密传输

服务器先拿出一个公钥和私钥
公钥注册到数字认证机构(CA)
CA 用自己的私钥将服务器的公钥进行数字签名并颁发数字证书
服务器把证书发送给客户端 客户端拿到数字证书后使用 CA 公钥确认证书是否合法 合法后客户端就可以通过服务器公钥给服务器发送数据了

加密用的密钥和解密用的密钥不一样
但是它们有关系,你不能通过公钥算出密钥
两个质数相成得到一个结果,正向乘很容易,但是给你一个乘积,你不知道它们是由哪个数乘出来的
e 幂数
n 素数
公钥 {e,n}
私钥 {d,n}
